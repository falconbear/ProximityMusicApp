# プロジェクト計画書（すれ違い音楽交換アプリ）

## ビジョンと目的
- すれ違い通信で「誰かの音楽」が自動再生される体験を提供し、パーソナライズ疲れに対する偶発的な発見を生む。
- KPI(初期): デイリーアクティブユーザー、1日あたりの再生曲数、すれ違い成立率、バッテリ消費(平均mAh/1h)。
- 非目標: レコメンド/ランキングを作り込むこと、重いソーシャル機能。

## スコープとMVP
- スコープ: 近接検知、匿名セッション確立、楽曲交換・再生、ブロック/お気に入り、オフライン保存と自動再生。
- MVP(初版):
  - 近接検知と端末間セッション確立（匿名IDローテーション）。
  - 楽曲サンプルのP2P転送とローカル保存。
  - 自動再生キュー、スキップ、ブロック。
  - バックグラウンド再生とシンプルなプレイヤーUI。
  - 簡易ログ/メトリクス、電池消費の基本対策。
- 後続: アクセシビリティ改善、詳細メトリクス、UX磨き込み、ストア要件最適化。

## 進め方（アジャイル/スクラム）
- 2週間スプリント、プロダクトバックログにユーザーストーリーで管理。
- Definition of Ready/Doneを明文化（テスト/Lint/アクセプタンス基準）。
- デモ/レトロを毎スプリントで実施、計測結果と体験フィードバックを反映。

## ロードマップ（初期スプリント案）
- スプリント0 (1週): Flutter環境/CIセットアップ、コード規約、Platform channelスパイクでiOS/Androidの近接API可否調査。
- スプリント1 (1–2週): 近接検知とセッション確立PoC、匿名ID生成・ローテーション、スキャン間隔の実験、イベント可視化UI、基本ユニットテスト。
- スプリント2 (1–2週): 短尺楽曲のP2P転送PoC、暗号化と一時鍵交換、リトライと転送完了確認、ローカル保存と自動再生キュー、バックグラウンド再生。
- スプリント3 (1–2週): 本番UIの第1版、ブロック/お気に入り、ストレージ上限とクリーンアップ、ログ/メトリクス、電池チューニング。
- スプリント4以降: 品質強化(負荷・バッテリ検証)、アクセシビリティ、ストア要件対応、法務・ライセンス確認を完了してベータ→本番。

## マイルストーン
- M1: 近接検知とセッション確立のPoC完了（実機2種で確認）。
- M2: 転送と自動再生のMVP完了、バックグラウンド再生OK。
- M3: ベータUX完成、電池/安定性基準を満たす、TestFlight/内部テスト配信。
- M4: ストア提出準備完了（法務チェック、ガイドライン適合、クラッシュ率基準）。

## 主要リスクと対応
- iOSのバックグラウンド制約: OSガイドラインに沿った利用とユーザ同意、スキャン間引きと通知で補完。
- 著作権・配信権: 権利クリアな音源のみ転送、利用規約/同意フローを導入、必要に応じてサーバ側で検証。
- 電池・帯域: スキャン間隔/送信サイズを制御、圧縮と一時停止、計測によるチューニング。
- プライバシー: 匿名IDローテーション、端末間の一時鍵交換、ローカル暗号化保存、オンボーディングで明示。

## ステークホルダー/体制（案）
- プロダクトオーナー、モバイルエンジニア(Flutter)、iOS/Androidネイティブサポート、QA、デザイナー、法務相談窓口。

## 計測と運用
- メトリクス: すれ違い成功数、転送成功率、再生完走率、スキップ率、バッテリ消費、クラッシュ率。
- 運用: フィーチャーフラグで機能段階リリース、Crashlytics/Sentryでモニタリング、リテンション/フィードバックをレトロに反映。
