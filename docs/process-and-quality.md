# 開発プロセスと品質計画

## プロセス
- スプリント: 2週間サイクル、計画→実装→レビュー→デモ→レトロ。
- バックログ管理: ユーザーストーリー単位で優先度付け、フィーチャーフラグ運用を前提。
- Definition of Done: Lint/Format通過、ユニット/ウィジェット/主要インテグレーションテスト通過、受け入れ基準満たす、ドキュメント更新。
- コードレビュー: 小さなPR(理想<300行差分)、自動チェック(GA/Bitrise/Codemagic)で静的解析とテストを実行。

## 品質/テスト
- 静的解析: `flutter analyze`, `dart format`, `dart test`, `melos`/`very_good_cli`等も検討。
- テスト階層:
  - Unit: UseCase/Repository/ロジック。
  - Widget: 主要画面のUI状態遷移。
  - Integration: 転送フェイクを使った再生フロー、バックグラウンド再生のサービス連携。
  - E2E(実機): 近接検知→転送→再生、バッテリ/パフォーマンス測定。
- モニタリング: Crashlytics/Sentry、ログ/メトリクス収集、バッテリ消費の定点観測。

## 配布・デプロイ
- ブランチ戦略: main(安定) / develop / feature branches。リリースごとにタグ。
- CI/CD: プルリクで lint/test、mainでビルドと自動配布(内部テスト/TestFlight)。
- 配布チャネル: TestFlight / Play Console内部テスト。段階リリースとフィードバック収集。

## リスクと対応（品質観点）
- 近接APIのOS制約: 実機検証のスパイクを継続、失敗時のフォールバックを設計。
- バッテリ/バックグラウンド: スキャン間引きと低電力モード検知、計測をCIレポート化。
- 著作権/プライバシー: 利用規約/同意フロー、権利クリアな音源のみ、ログの匿名化・最小化。
